CREATE INDEX idx_account_db_id ON arena_members (account_db_id);

WITH limits AS (
  SELECT ROUND(COUNT(DISTINCT account_db_id) * 0.05) AS limit_value
  FROM arena_members
)
SELECT account_db_id, SUM(damage) AS total_damage
FROM arena_members
GROUP BY account_db_id
ORDER BY total_damage DESC
LIMIT (SELECT limit_value FROM limits);
